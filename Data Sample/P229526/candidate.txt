this article outlines the overall strategy and summarizes a few key innovations of the team that won the first netflix progress prize. providing personalized point of interest recommendation has become a major issue with the rapid emergence of location based social networks. unlike traditional recommendation approaches, the lbsns application domain comes with significant geographical and temporal dimensions. moreover most of traditional recommendation algorithms fail to cope with the specific challenges implied by these two dimensions. fusing geographical and temporal influences for better recommendation accuracy in lbsns remains unexplored, as far as we know. we depict how matrix factorization can serve poi recommendation, and propose a novel attempt to integrate both geographical and temporal influences into matrix factorization. specifically we present geomf td, an extension of geographical matrix factorization with temporal dependencies. our experiments on a real dataset shows up to \ benefit on recommendation precision. location based social networks have attracted an inordinate number of users and greatly enriched the urban experience in recent years. the availability of spatial, temporal and social information in online lbsns offers an unprecedented opportunity to study various aspects of human behavior, and enable a variety of location based services such as location recommendation. previous work studied spatial and social influences on location recommendation in lbsns. due to the strong correlations between a user check in time and the corresponding check in location, recommender systems designed for location recommendation inevitably need to consider temporal effects. in this paper, we introduce a novel location recommendation framework, based on the temporal properties of user movement observed from a real world lbsn dataset. the experimental results exhibit the significance of temporal patterns in explaining user behavior, and demonstrate their power to improve location recommendation performance. or commercial advantage and that copies bear this notice and the full citation on the rst page. the rapid growth of location based social networks has attracted billions of users, promoting our urban experience to a new stage. typical location based social networking sites allow a user to check in at a location of interest with her smartphone, which informs her friends, along with creating the opportunity to make new friends http: foursquare com http: www facebook com about location permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for pro. copyrights for components of this work owned by others than acm must be honored. to copy otherwise, or republish, to post on servers or to redistribute to lists, requires prior speci. lbsn users and advance location based marketing, location recommendation on lb sns has become an essential task, aiming to recommend new pois to a user according to his personal preferences and facilitate his exploration of new areas of the city. location based social networks present unprecedented large scale check in data to describe a usermobile behavior in spatial, temporal, and social aspects. in previous work researchers explored users personal static check in preferences through geographical check ins for location recommendation. inspired by social in uence theories that social friends tend to have similar check in behavior, researches started to investigate the explicit social friendships on lbsns and leverage their power for improving location recommendation services. among existing work, the temporal patterns of a usercheck in actions have not been explored in depth. as suggested in, human geographical movement exhibits signi cant temporal patterns on lbsns and is highly relevant to the location property, while the daily pattern is one of the most fundamental patterns that re ects a usermobile behavior. for example, a user may regularly arrive to the. ce around am, go to a restaurant for lunch at pm, and watch movies at night around pm. therefore, investigating the features embedded in daily patterns enables us to better understand human mobile behavior, providing a potential opportunity to design more advanced location recommender systems on lbsns. previous work reports that a userpreferences change continuously over time, indicating two temporal properties of a userdaily check in preferences: non uniformness: a user exhibits distinct check in preferences at di erent hours of the day; and consecutiveness: a user tends to have more similar checkin preferences in consecutive hours than in non consecutive hours. in section # we validate these properties experimentally on a realworld dataset. figure # plots an illustrative example of a useraggregated check in activities on his top most visited locations over hours on a real world lbsn. each cell represents the total number of check in activities happened at a speci. location during the corresponding hour, colored from black to white. the usercheck in behavior presents a different check in location distribution at each hour, which changes continually over time. the non uniformness and consecutiveness properties suggest strong correlations between a usercheck in time and the corresponding check in preferences. however, these properties have not been exploited for location recommendation on lbsns. in this paper, we aim to leverage them for location recommendation. to the best of our knowledge, this is the rst work of modeling temporal ef figure #: daily check in activities on lbsn fects on location based social networks for location recommendation. the contributions of this paper are summarized below: we propose a location recommendation framework with temporal. we introduce four temporal aggregation strategies to integrate a usercheck in preferences of di erent temporal states. ects for location recommendation; the results exhibit its good recommendation performance, and demonstrate the advantage of considering time dependent check in preferences over static check in preferences. the remainder of this paper is organized as follows. we rst give a brief review of some related work in section #, then introduce a basic location recommendation model and discuss the modeling of temporal properties in section #. next we introduce our location recommendation framework lrt with temporal. ects in terms of temporal regularization and temporal aggregation in section #, followed by the discussion of experimental design and results on a real world lbsn dataset in section #. we conclude this work with future work in section #. point of interest recommendation has become an important means to help people discover attractive locations. however, extreme sparsity of user poi matrices creates a severe challenge. to cope with this challenge, viewing mobility records on location based social networks as implicit feedback for poi recommendation, we first propose to exploit weighted matrix factorization for this task since it usually serves collaborative filtering with implicit feedback better. besides, researchers have recently discovered a spatial clustering phenomenon in human mobility behavior on the lbsns, ie, individual visiting locations tend to cluster together, and also demonstrated its effectiveness in poi recommendation, thus we incorporate it into the factorization model. particularly, we augment users and pois latent factors in the factorization model with activity area vectors of users and influence area vectors of pois, respectively. based on such an augmented model, we not only capture the spatial clustering phenomenon in terms of two dimensional kernel density estimation, but we also explain why the introduction of such a phenomenon into matrix factorization helps to deal with the challenge from matrix sparsity. we then evaluate the proposed algorithm on a large scale lbsn dataset. the results indicate that weighted matrix factorization is superior to other forms of factorization models and that incorporating the spatial clustering phenomenon into matrix factorization improves recommendation performance. with the popularity of smart mobile devices and the diversi cation of positioning technologies, it has become easier for people to acquire real time information regarding their locations. this development has triggered the advent of location based social networks, such as foursquare, jiepang, facebook place and so on. this emergence has not only led to location based socializing becoming a new form of social interaction, but has also helped people speed up familiarization of the surroundings. to achieve the latter goal, point of interest recommendation has become one important means. recently, poi recommendation has become a popular research topic due to easy access of large scale mobility records and inclusion of social network information. one of the most important problems in poi recommendation is how to deal with a severe challenge stemming from extreme sparsity of user poi matrices. to this end, viewing mobility records on the lbsns, ie, check ins, as implicit feedback for poi recommendation, we rst propose to exploit weighted matrix factorization for this task because it usually serves collaborative ltering with implicit feedback better than the other approaches. in this algorithm, users and pois are mapped onto a joint latent space by approximating a user poi rating matrix in a weighted way, such that a userpreference for a poi is modeled as inner product between them in that space. the reasons that check ins can be considered as implicit feedback for poi recommendation lies in the following three aspects: rst, checkin datasets just include the locations where users have been and therefore they likely prefer. in other words, they just provides positive examples. second, the visit frequencies of a user to her visiting locations re ect her con dences of being fond of them. the visiting patterns of higher frequency indicate the preferences of higher con dence. third, locations where a user has never visited are either really unattractive or undiscovered but potentially appealing. however, these two cases are usually di cult to di erentiate from each other if no extra information is provided. fortunately, due to inclusion of geographical information of pois, some researchers have recently discovered a spatial clustering phenomenon in human mobility behavior on the lbsns, ie, individual visiting locations tend to cluster together, and leveraged it to assist poi recommendation. for example, ye et al characterized it by a power law distribution on the distance between any pair of visited locations. instead of making the power law distributed assumption, zhang et al directly performed kernel density estimation to this distribution. to avoid the cost in computing the distance between paired locations, in, the authors modeled the spatial clustering phe nomenon in terms of geo clustering and tried to estimate individual spatial distribution. actually, by modeling the userspatial clustering phenomenon, it becomes possible to partially distinguish unattractive locations from undiscovered but potentially appealing ones. in particular, it is much more likely that unvisited pois near a frequently visited location are really unattractive and this likelihood depends on the visit frequency to that location. this is because if a user often visits a certain poi but has never patronized surrounding pois, it is highly unlikely for her to visit them in the future. for the sake of joint geographical modeling and matrix factorization, we augment users and pois latent factors of the factorization model with non negative activity area vectors of users and non negative in uence area vectors of pois, as shown in figure #. these augmenting vectors consist of a set of grids with the same xed size. each entry in a useractivity area vector represents the possibility of this user showing up in the corresponding grid while each entry in a poiin uence vector indicates the degree of in uence that this poi has on the corresponding grid. the reason for such an explicit augmentation with geographical information is that there is still no evidence showing that the latent space has included geographical information. in this way, a userpreference for a poi is modeled as inner product between them in the augmented space and thus includes both the interest of the user from the latent space and her preference for the location of the poi. if a userpreference for the location of a poi is non zero, the activity areas of the user intersect with the in uence areas of the poi so that this poi is reachable from the activity areas of the user. in other words, it is possible for the attractiveness of the poi to cross the gap arising from the distance. more importantly, it is possible to exploit such a representation of users preference to partially distinguish unattractive locations from undiscovered ones. letgo back to the previous example, where a user often visited a poi, but has never patronized pois nearby. using such a representation, the user has similar location preference for the pois around. however, since this user has never visited nearby pois, from the perspective of approximation, such a representation requires inner product in the latent space to. therefore, we have introduced more potentially unattractive locations into matrix factorization. thus, it explains why the incorporation of spatial clustering phenomenon into the factorization model can help to deal with the challenge stemming from the user poi matrix sparsity. when only considering augmenting vectors in the proposed model and assuming that in uence areas of pois are xed in advance, the proposed model is reduced to a nonnegative weighted least square problem. supposing that in uence on a grid from a poi is determined by the density at the gridcenter of the two dimensional normal distribution centered at this poi, the reduced model encompasses twodimensional kernel density estimation on individual visiting poil poi figure #: the augmented model for weighted matrix factorization, where the dimension of latent space isand the number of grid areas is. in particular, the estimated density at a locationwith respect to a user equals to the averaging density at the locationof the normal distributions centered at each of her visiting locations, or inversely, it equals to the averaging density at each of her visiting locations of the normal distribution centered at the location. when mapping pois onto grids and constituting users activity area vectors with grids and their visited frequency, the estimated density is in proportion to inner product between the augmenting vectors. thus, two dimensional kernel density estimation is a special case of the reduced model so that our model captures the spatial clustering phenomenon from the perspective of kernel density estimation. however, di erent from kde, the advantage of the proposed model lies in its consistent objective goal with weighted matrix factorization. therefore, the modeling of the spatial clustering phenomenon is seamlessly incorporated into matrix factorization. to summarize, in this paper, we have made the following contributions to poi recommendation. according to the analysis to mobility records from a location based social network for poi recommendation, these mobility records are considered as implicit feedback for recommendation systems. therefore, we propose to leverage weighted matrix factorization to conduct poi recommendation. due to the existence of accurate geographical locations of pois, we propose augmenting users and pois latent factors with activity area vectors of users and in uence area vectors of pois. based on such an augmented model, we can not only capture the spatial clustering phenomenon from the aspect of twodimensional kernel density estimation, but we are also able to explain why the modeling of the spatial clustering phenomenon can help to cope with the challenge of recommendation arising from the user poi matrix sparsity. moreover, since its objective goal is consistent with weighted matrix factorization, the modeling of the spatial clustering phenomenon is seamlessly incorporated into matrix factorization. we evaluate the proposed algorithm on a large scale location based social network dataset. the results not only show the superiority of weighted matrix factorization on poi recommendation to other forms for factorization models, but they also indicate that incorporating the spatial clustering phenomenon into matrix factorization improves recommendation performance. due to its complexity and its connection to location based social networks, the decision process of a user choose a poi is complex and can be influenced by various factors, such as user preferences, geographical influences, and user mobility behaviors. while there are some studies on poi recommendations, it lacks of integrated analysis of the joint effect of multiple factors. to this end, in this paper, we propose a novel geographical probabilistic factor analysis framework which strategically takes various factors into consideration. also, the user mobility behaviors can be effectively exploited in the recommendation model. finally, experimental results on real world lbsns data show that the proposed recommendation method outperforms state of the art latent factor models with a significant margin. the problem of point of interest recommendation is to provide personalized recommendations of places of interests, such as restaurants, for mobile users. specifically, this framework allows to capture the geographical influences on a user check in behavior. moreover, the recommendation model can effectively make use of user check in count data as implicity user feedback for modeling user preferences. recent years have witnessed the increased development and popularity of location based social network services, such as foursquare, gowalla, and facebook places. copyrights for components of this work owned by others than acm must be honored. lbsns allow users to explore point of interest, such as restaurants and shopping malls, for better services by sharing their check in experiences and opinions on the pois which they have checked in. indeed, the task of poi recommendation is to provide personalized recommendations of places of interests to mobile users. it plays an important role in providing better location based services in location based social networks. in fact, both lbsn users and poi owners can bene. for mobile users, they can identify favorite pois and have better user experiences by the right poi recommendations. also, for poi owners, they could exploit poi recommendation for acquiring more target customers. two pois with similar or the same semantic topics can have di erent popularities if they are located in di erent regions. in lbsns, a user may check in pois at di erent regions. for example, a lbsn user may travel to di erent cities. dynamic user mobility imposes huge challenges on poi recommendations. in the study of poi recommendations, the explicit user ratings are usually not available. indeed, traditional recommender systems usually assume that the user and item data are independent and identically distributed. rst law of geography and the law of demand, the propensity of a user for a poi is inversely proportional to the distance between the user and the poi, which is similar to the probability of purchasing an item is inversely proportional to the cost. another unique characteristic of poi recommendations is that user check in count data follow a power law distribution. this is di erent from the ratingdata in traditional recommender systems. in other words, a user can visit a poi only once and another poi hundreds of times. since we do not have explicit user rates for pois, we can only make use of implicit user behavior data in the check in records for poi recommendations. all the above demands a reconsideration of the recommendation model. while there are some studies on poi recommendations, it lacks of integrated analysis of the joint. ect of the above factors, such as user preferences, geographical in uences, and user mobility behaviors. therefore, in this paper, we propose a geographical probabilistic factor analysis framework which can strategically takes various factors into consideration. this framework allows to capture the geographicalin uences on a usercheck in behaviors,ectivelymodel the user mobility patterns, and deal with the skewed distribution of check in count data. this can re ect the rst law of geography; that is, similar pois are more related than distant pois. also, we use a multinomial distribution over latent regions to model user mobility behaviors over di erent activity regions. these latent regions re ect the activityareas for allthe users through a collective in uence. moreover, a latent model is developed to capture user preferences. this model takes geographical in uence, regional popularity and user mobility into consideration, and can. ectively handle the skewed data distribution of poi count data. finally, experimental results on real world lbsns and poidata show thatthe proposedpoirecommendation method outperforms state of the art probabilistic latent factor models with a signi cant margin in terms of toprecommendation. permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for pro. or commercial advantage and that copies bear this notice and the full citation on the rst page. to copy otherwise, or republish, to post on servers or to redistribute to lists, requires prior speci. there are several unique characteristics of lbsns which distinguish poi recommendations from traditional recommendation tasks. everything is related to everything else, but near things are more related than distant thing. this indicates that geographically proximate pois are more likely to share similar characteristics. also, the probability of a user for a poi is inversely proportional to geographic distance. the recommender system has to infer user preferences from implicit user feedback in terms of user check in frequency data. in fact, the decision process of a user choose a poi is complex and can be in uenced by many factors. in economics, utility is an index of preferences over some sets of items and services when a user makes purchase decisions. in other words, a user may prefer a far away poi than a nearby one for better satisfaction. in fact, the probability of a user purchasing a product is largely. ected by the wordof mouth about the product. finally, the lbsn users have dynamic mobilitybehaviors, which impose the challenges on the modeling of check in decision. speci cally, a gaussian distribution is used to represent a poi over a sampled region. also, we provide a location marketing segmentation study by comparing the latent regions identi ed by our model with those derived from traditional marketing segmentation methods. location based social networks offer researchers rich data to study people online activities and mobility patterns. one important application of such studies is to provide personalized point of interest recommendations to enhance user experience in lbsns. previous solutions directly predict users preference on locations but fail to provide insights about users preference transitions among locations. in this work, we propose a novel category aware poi recommendation model, which exploits the transition patterns of users preference over location categories to improve location recommendation accuracy. our approach consists of two stages: preference transition prediction, and category aware poi recommendation. matrix factorization is employed to predict a user preference transitions over categories and then her preference on locations in the corresponding categories. real data based experiments demonstrate that our approach outperforms the state of the art poi recommendation models by at least in terms of recall. by aggregating the check in data of millions of users, the lbsn has become a promising platform for studying users online activities and mobility patterns. a lot of applications can be built on the basis of such studies, among which recommending personalized pois to individual users is of particular interest, and has recently received a lot of research attention. for example, ye et al and cheng et al employed collaborative ltering to recommend pois, taking into account geographical and social in uence. however, most existing approaches directly predict a userpreference on a location but fail to deeply investigate the essence of transitions of a userpreference on locations. failing to handle this important issue leads to inaccurate poi recommendation, since it is very challenging to accurately predict the next location from a huge candidate pool, and in particular, when input information is sparse, which is very common in lbsns. in order to improve the accuracy of poi recommendation, we investigate the patterns of users preference transitions over location categories. in lbsns, pois are typically organized by a hierarchical category tree. ers a level category hierarchy where top level consists of night life, food, etc, and lower level consists of bar, pub, japanese food, co ee, etc. intuitively, such category information indicates the semantic meaning of a location, so a usercheck in at a given location re ects her preference on the corresponding category. following previous work, we assume users next check in locations depend on their current locations. by studying patterns of users preference transitions over location categories, we are able to infer the categories of their next check in locations. categories, poi recommendations can be more accurate compared to traditional solutions where no category information is considered. theoretically, if a user has su cient historical check in data, her preference transitions can be reliably predicted. however, in a real world lbsn, users check in data is often sparse. furthermore, even if a user has enough check in data, she often presented new preference transitions. such issues make traditional solutions ine ective for preference transition prediction. therefore, we apply collaborative ltering to learn a usertransition patterns by leveraging other similar users transition patterns. similar users are clustered based on their check in frequency in di erent categories, taking into account temporal. for each cluster, matrix factorization is used to predict a userpreference transitions. once the top most likely categories of a usernext check in are predicted, we apply another matrix factorization to predict a userpreference on locations in the categories. by studying check in data from a real lbsn, we found that the displacement from a user current location to the next one follows power law distribution. we thus combine such geographical in uence and users preference on locations to make the top poi recommendations in each category, producing top pois for a target user given her current check in information. the contributions of this work are as follows: to have a better understanding of a userpreference transitions, we propose the concept of story to structure her check in activities. in a story, two consecutive check in activities happened within a prede ned time interval, thus are better correlated with each other. due to data sparsity of individual users, we propose to cluster similar users for accurate poi recommendation, taking into account both category information and temporal. for each user cluster, we apply mf to predict the possible categories of a usernext checkin location, given the category of her current location. once the possible categories of next check in locations are inferred, we again apply mf to predict a userpreference on the locations in the corresponding categories, considering geographical in uence. we evaluate the performance of the proposed poi recommendation method on real data collected from gowalla. experimental results show that our approach signi cantly outperforms the state of the art solutions by at least in terms of recall. in many application domains of recommender systems, explicit rating information is sparse or non existent. the preferences of the current user have therefore to be approximated by interpreting his or her behavior, ie, the implicit user feedback. in the literature, a number of algorithm proposals have been made that rely solely on such implicit feedback, among them bayesian personalized ranking. in the bpr approach, pairwise comparisons between the items are made in the training phase and an itemis considered to be preferred over itemif the user interacted in some form withbut not with. in real world applications, however, implicit feedback is not necessarily limited to such binary decisions as there are, eg, different types of user actions like item views, cart or purchase actions and there can exist several actions for an item over time. in this paper we show how bpr can be extended to deal with such more fine granular, graded preference relations. an empirical analysis shows that this extension can help to measurably increase the predictive accuracy of bpr on realisticcommerce datasets. most of the published collaborative filtering recommendation approaches aim to identify patterns of user preferences within a set of explicit item ratings provided by a larger user community. in practice, however, this form of explicit feedback from the users in many application domains is very sparse, limited to dominantly positive or positive only statements, or even non existent. recsys, october, year#, foster city, silicon valley, ca, usa. dietmar jannach tu dortmund, germany dietmar jannach tu dortmund de correspondingly, a number of proposals have been made in the literature to exploit implicit user feedback in the recommendation process, eg, in these cases, a usertrue preferences are estimated by interpreting his or her behavior. on an online shop, for example, one will typically interpret user actions like an item purchase or viewing an item for some time as a sign of interest in the item. bayesian personalized ranking is a comparably recent cf method designed to deal with implicit only feedback. one particularity of bpr when compared, eg, to the highly accurate svd based method is that it directly aims to optimize a ranking criterion, whereas svd primarily aims to minimize the prediction error. therefore, bpr can be considered to fall into the class of learning torank methods which due to their design are typically able to outperform methods designed for error minimization on rank measures like precision, recall or ndcg. in the bpr approach, the input consists of a user item rating matrix, which however only captures positive interactions, ie, there is a one whenever a userhas interacted with item. at its core, bpr uses the pairwise preferences derived from the implicit ratings to optimize an auc like ranking criterion and rendle et al show how this optimization can be applied to two typical classes of recommendation models. one limitation of the basic bpr model is that it only supports discrete, unary feedback. in practice, however, some types of user interactions might be considered stronger indicators of interest than others. a purchase action might be stronger than a view action; multiple clicks on an item might be more indicative than a single click; nally, a recent view action might be more relevant than one in the past. in this work, we propose an extension to bpr, which is designed to take various forms of such graded implicit feedback into account. the main idea is to rst derive additional pairwise preferences from the data using the available importance information and in the optimization phase bias the optimization procedure to draw a certain amount of samples from these additionally available data points. in the next section, we describe the approach in more detail before we present results of an experimental evaluation with di erent datasets. tagging plays an important role in many recent websites. recommender systems can help to suggest a user the tags he might want to use for tagging a specific item. factorization models based on the tucker decomposition model have been shown to provide high quality tag recommendations outperforming other approaches like pagerank, folkrank, collaborative filtering, etc. the problem with td models is the cubic core tensor resulting in a cubic runtime in the factorization dimension for prediction and learning. in this paper, we present the factorization model pitf which is a special case of the td model with linear runtime both for learning and prediction. the model is learned with an adaption of the bayesian personalized ranking criterion which originally has been introduced for item recommendation. empirically, we show on real world datasets that this model outperforms td largely in runtime and even can achieve better prediction quality. besides our lab experiments, pitf has also won the ecml pkdd discovery challenge year# for graph based tag recommendation. pitf explicitly models the pairwise interactions between users, items and tags. tagging is an important feature of the web. it allows the user to annotate items resources like songs, pictures, bookmarks, etc. tagging helps the user to organize his items and facilitate eg, browsing and searching. tag recommenders assist the tagging process of a user by suggesting him a set of tags that he is likely to use for an item. personalized tag recommenders take the usertagging behaviour in the past into account when they recommend tags. that means each user is recommended a personalized list of tagsie, the suggested list of tags depends both on the user and the item. personalization makes sense as people tend to use di erent tags for tagging the same item. this can be seen in systems like last fm that have a nonpersonalized tag recommender but still the people use different tags. in an empirical example was shown where recent personalized tag recommenders outperform even the theoretical upper bound for any non personalized tag recommender. this work builds on the recent personalized tag recommender models using factorization models. the drawback of using full td is that the model equation is cubic in the factorization dimension. that makes td models using a high factorization dimension unfeasible for midsized and large datasets. in this paper, we present a new factorization model that explicitly models the pairwise interactions between users, items and tags. the advantage of this model is that the complexity of the model equation is linear in the number of factorization dimensions which makes it feasible for high dimensions. our experimental results also indicate that our pairwise interaction model clearly outperforms the cd model in prediction quality and slightly in runtime. furthermore for learning tag recommender models in general, we adapt the bayessian personalized ranking optimization criterion from item recommendation to tag recommendation. in all, our contributions are as follows: we extend the bayessian personalized ranking optimization criterion to the task of figure #: the observed data in a tagging system forms a ternary relationbetween users, itemsand tags. on the right side, the cubeslices per user are placed next to each other. note that only positive observations are made; there are no explicit observations of negative tagging events. tag recommendation and provide a learning algorithm based on stochastic gradient descent with bootstrap sampling. this optimization criterion and learning algorithm is generic and not limited to factorization models like td. these models like higher order singular value decomposition and ranking tensor factorization are based on the tucker decomposition model. rtf has shown to result in very good prediction quality. in statistics, another approach for tensor factorization with a model equation of linear complexity is the canonical decomposition aka parallel factor analysis. we will show that our model is a special case of both cd and td. in this paper, we tackle the problem of topcontext aware recommendation for implicit feedback scenarios. we frame this challenge as a ranking problem in collaborative filtering. much of the past work on cf has not focused on evaluation metrics that lead to good toprecommendation lists in designing recommendation models. in addition, previous work on context aware recommendation has mainly focused on explicit feedback data, ie, ratings. we propose tfmap, a model that directly maximizes mean average precision with the aim of creating an optimally ranked list of items for individual users under a given context. tfmap uses tensor factorization to model implicit feedback data with contextual information. the optimization of map in a large data collection is computationally too complex to be tractable in practice. to address this computational bottleneck, we present a fast learning algorithm that exploits several intrinsic properties of average precision to improve the learning efficiency of tfmap, and to ensure its scalability. we experimentally verify the effectiveness of the proposed fast learning algorithm, and demonstrate that tfmap significantly outperforms state of the art recommendation approaches. collaborative filtering methods are at the core of most recommendation engines. most of the data traces left by online users come in the form of implicit feedback, ie, we know which items a user interacted, eg, purchased, used, or this work was conducted when the rst author was an intern at telefonica research, barcelona. permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for pro. or commercial advantage and that copies bear this notice and the full citation on the rst page. to copy otherwise, to republish, to post on servers or to redistribute to lists, requires prior speci. clicked, etc, and possibly also the count of each interaction; however, we do not have an explicit rating, ie, a relevance score, that represents the strength of the userinterest in that item. learning the suggestion function from implicit feedback data, such as purchase or usage logs, can either be considered a classi cation problem, where items are classi ed to relevant or irrelevant, or a ranking problem where an optimal list of items is to be computed. toprecommendation has recently attracted increased research interest because it generates a ranked list of results, which is directly connected to the end user satisfaction. conventionally, recommender systems have been optimized to produced scores. a predicted score re ects the systemhypothesis of the strength of a particular userpreference for a particular item. in an overwhelmingly large number of recommender system use scenarios, users do not want preference strength information on all the items in the collection, but rather a compact list of top recommended items. although ranking oriented cf approaches have been proposed for explicit feedback domains, eg, eigenrank and cofirank, those approaches are di cult to apply to implicit feedback domains, since they require training examples that are derived from the users ratings on various items. in particular, implicit feedback is often binary in nature. we notice that in toprecommendation, the quality of a recommendation list that contains items of binary relevance can be quanti ed using mean average precision, a well known evaluation measure in the information retrieval community. map provides a single gure measure of quality across recall levels, has especially good discrimination and stability properties, and roughly corresponds to the average area under the precision recall curve. it is thus a good measure of performance when a short list of the most relevant items is shown to users. a state of theart approach, bayesian personalized ranking, has been recently proposed to train recommendation models by optimizing the measure of the area under the roc curve, which is based on pairwise comparisons between items. note that in the auc measure mistakes at the top of the list carry equal weight to mistakes in the bottom of the recommendation list. in contrast to auc, map is a listwise measure, for which mistakes in the recommended items at the top of the list carry a higher penalty than mistakes at the bottom of the list. users typically consider only few top ranked items in the recommendation list, it is thus particularly important to get the recommendations at the top of the list right. the top heavy bias of map is thus particularly important in the recommendation problem. for this reason, we propose a recommendation model for implicit feedback domains by directly optimizing map. typically, recommender systems have access to additional information about the user item interactions, such as the context that is associated with the user item interaction. the context could be the location where the user listened to a song on his her mobile phone or the time of the user item interaction. context aware recommendations are a new paradigm that can signi cantly improve the recommendation relevance and quality, compared to conventional recommendations solely based on user item interactions. in this paper we present a generic cf model that is based on a generalization of matrix factorization to address context aware recommendations. we extend the concept of matrix factorization to tensor factorization. a tensor is a generalization of the matrix concept to multiple dimensions. in the example above the user item two dimensional matrix is converted into a three dimensional tensor of useritem location interactions. two key issues need to be considered in cars: context integration. the contextual information needs to be integrated in the recommendation model to be able to bene. the quality of the recommendation; and optimization function. the recommendation model needs to be optimized under an objective function that corresponds to the recommendation quality for each user under each given context. previous work in cars has extensively studied the context integration issue, such as using tensor factorization and factorization machines. however, the second issue has only been addressed in a simplistic way. in the work of and, the objective function in the recommendation model consists of minimizing the rating prediction error. ective strategy where explicit feedback data is available from users, however, optimizing this objective is infeasible for scenarios with only implicit feedback data. in these scenarios, the quality of a recommendation list for a user is solely dependent on the positions of the relevant items in the list under the given context. here we propose a new context aware recommendation approach based on tensor factorization for map maximization that is designed to work with implicit feedback datasets. taking insights from the area of learning to rank, tfmap directly optimizes map for learning the model parameters, ie, latent factors features of users, items and context types, which are then used to generate item recommendations for users under di erent types of context. directly optimizing map across all the users in a data collection is an expensive and non trivial task. therefore, we also propose a fast learning algorithm that exploits several properties of the average precision measure. we show that the computational complexity of the fast learning algorithm for tfmap is linear in the number of observed items in a given data collection. our contributions in this paper can be summarized as: we propose a new generalized cf approach, tfmap, that directly optimizes for map and leverages contextual information when available. we demonstrate that tfmap outperforms state of the art context aware and context free approaches. we observe signi cant improvements not only in map but also in precision at the topranked recommendations. to the best of our knowledge, tfmap is also the rst approach that can exploit datasets with implicit user feedback and contextual information. we propose a fast learning algorithm that ensures the scalability of tfmap and that exploits several properties of the ap measure. the paper is organized as follows: in section # we discuss the most relevant previous work and position our paper with respect to it. the research problem and the terminology used throughout the paper are presented in section #. in section #, we present the detail of tfmap and the fast learning algorithm. our experimental evaluation is reported in section #. finally, section # summarizes our main contributions and highlights a few areas of future work. in ranking with the pairwise classification approach, the loss associated to a predicted ranked list is the mean of the pairwise classification losses. this loss is inadequate for tasks like information retrieval where we prefer ranked lists with high precision on the top of the list. we propose to optimize a larger class of loss functions for ranking, based on an ordered weighted average of the classification losses. moreover, we show that owa aggregates of margin based classification losses have good generalization properties. convex owa aggregation operators range from the max to the mean depending on their weights, and can be used to focus on the top ranked elements as they give more weight to the largest losses. when aggregating hinge losses, the optimization problem is similar to the svm for interdependent output spaces. experiments on the letor benchmark dataset for information retrieval validate our approach. similarly to the original setting, we start from pairwise losses, and aggregate them. the related work is discussed in section #. we address the problem of learning scoring functions, motivated by ranking tasks in information retrieval. considering the example of document retrieval, when given a query, the scoring function associates a scalar to each document. the documents are then presented to the user, in decreasing order of scores. these last few years, there has been a large amount of work on learning to rank, especially on the problem of obtaining a high precision on the top of the list. finally, the third category of approaches de ne new multivariate loss functions, easier to optimize, that consider the vector of scores produced for a given query. these recent works share the same goal: going beyond the historical ranking framework, the pairwise classi cation approach. in the context of information retrieval, convex losses for ranking were created by taking the mean of the pairwise classi cation losses. the loss can then be upper bounded by taking the maximum of the pairwise losses. this loss focuses on the top ranked element, but it is still inadequate for ir tasks because it does not provide any rank information when a relevant element is not in the rst position. overall, the limits of the pairwise approach in ranking does not seem to be a consequence of considering each pair individually, but to the small expressivity of the max and mean aggregation operators. however, instead of using the max or the mean, we use convex ordered weighted averaging operators. choosing an owa operator between these two extreme cases leads to optimizing an error that focuses on the top ranked elements, as required in ir tasks. we show in section # that the notion of margin can be extended to our framework, yielding margin based generalization error bounds. we present the experimental evaluation of our algorithm in section # on the letor benchmark dataset for information retrieval. the quality of this sorted list of documents depends on the position of the documents that are relevant to the query; and since the user considers only the few rst documents, it is desirable to have a high precision on top appearing in proceedings of the th international conference on machine learning, montreal, canada, year#. learning to rank is the problem of choosing an. ective scoring function using a training set of queries for which relevant documents are known. in the rst category, the methods de ne smooth approximations of quality measures used in ir, in a regression framework or using probability distributions on predicted ranks. in the second category, the methods use convex upper bounds on these metrics, using boosting, or as a large margin structured output prediction problem. in our context, this approach can be explained as follows: the position of a given relevant element in the sorted list can be computed by counting the number of irrelevant elements that have a higher score. learning with such a loss function is equivalent to optimizing the mean rank of the relevant documents. in this context, the limit of the pairwise approach is that the mean rank does not provide information on the top of the list. the pairwise approach has also been used in the context of right year# by the author owner. multiclass classi cation, considering, for each exam ple, pairs of the form. in this paper, we present an extension of the pairwise classi cation approach. these operators are parameterized by a set of decreasing weights aj, and make a weighted sum of the classi cation losses, where the weight aj is associated to theth highest loss. depending on their weights, convex owa operators range from the max to the mean operators, thus strictly extending existing pairwise classi cation approaches. the rest of the paper is organized as follows. we present basic de nitions in section #, and de ne the ordered weighted pairwise classi cation approach in section #. we consider in section # a largemargin formulation of owpc, and show that existing optimization algorithms for structured output predictions can be used for training linear scoring functions. this count can be carried out by building the pairs of elements, and checking the sign of the di erence of scores. in this paper, we aim to provide a point of interests recommendation service for the rapid growing location based social networks, eg, foursquare, whrrl, etc. our idea is to explore user preference, social influence and geographical influence for poi recommendations. in addition to deriving user preference based on user based collaborative filtering and exploring social influence from friends, we put a special emphasis on geographical influence due to the spatial clustering phenomenon exhibited in user check in activities of lbsns. we argue that the geographical influence among pois plays an important role in user check in behaviors and model it by power law distribution. accordingly, we develop a collaborative recommendation algorithm based on geographical influence based on naive bayesian. furthermore, we propose a unified poi recommendation framework, which fuses user preference to a poi with social influence and geographical influence. finally, we conduct a comprehensive performance evaluation over two large scale datasets collected from foursquare and whrrl. experimental results with these real datasets show that the unified collaborative recommendation approach significantly outperforms a wide spectrum of alternative recommendation approaches. with the rapid development of mobile devices, wireless networks and web technology, a number of locationbased social networking services, eg, loopt, brightkite, foursquare and whrrl, have emerged in recent years. these lbsns allow users to establish cyber links to their friends or other users, and share tips and experiences of their visits to plentiful point of interests, eg, restaurants, stores, cinema theaters, etc. in lbsns, a poi recommendation service, aiming at recommending new pois to users in order to help them explore new places and know their cities better, is an essential function that has received a lot of research momentum recently. friends link user check in activity map poi figure #: graph representation of user user friendship and user location check in activity in a lbsn indeed, facilitating poi recommendations in lbsns is a promising and interesting research problem because valuable information such as the cyber connections among users as well as the physical interactions between users and locations have been captured in the systems. nevertheless, these information have not been fully explored in prior research studies relevant to poi recommendations. have extracted visited locations from gps trajectory logs of mobile users for location recommendations. however, their studies consider neither the social links between users nor the interactions between users and locations in the recommendation process. in this paper, we aim to exploit the unique geographical implications em www loopt com www brightkite com www foursquare com www whrrl com these services are often referred as location based social networks and thus abbreviated as lbsns in the paper. bedded in users interactions with locations, in addition to applying the social in uence from users friends, for poi recommendations in lbsns. users and pois are two essential types of entities in lb sns. as illustrated in figure #, users in an lbsn, denoted as, are interconnected via social links to form a user social network. moreover, pois, denoted as, are connected with users via their check in activities, which generally re ects the users tastes on various pois. finally, as also logically illustrated in the gure, the pois, geocoded by, are constrained geographically. to make recommendations of pois to users, obviously the records of previous user check in activities are very useful. with the availability of such information in lbsns, an intuitive idea for supporting poi recommendations is to employ the conventional collaborative ltering techniques by treating pois as the items in many successful cf based recommender systems. the basic argument for this idea is that users tastes can be deduced by other users who exhibit similar visiting behaviors to pois in previous check in activities. thus, user based or itembased collaborative ltering techniques may be applicable to poi recommendations. additionally, the social network of users, which is handily available in the lbsn, can be explored to enhance performance of poi recommendations. recent studies have argued that social friends tend to share common interests and thus can be used in the process of collaborative ltering for making recommendations. while the ideas above aim to explore the essential information available in lbsns, ie, the user location interactivities and user user social links, we argue that the geographical in uence naturally existing in the activities of users and their geographical proximities cannot be ignored. according to toblerfirst law of geography everything is related to everything else, but near things are more related than distant things. thus, a user intuitively tends to visit nearby pois. there are two major implications that can be derived from this intuition for poi recommendations: people tend to visit pois close to their homes or. ces; and people may be interested in exploring nearby pois of a poi that they are in favor of, even if it is far away from home, eg, a user may explore some restaurants and shops around time square when she goes there for a broadway show. due to the geographical nature of the lbsns, we believe the geographical in uence between users and pois as well as that amongst pois are as important as the social in uence amongst users, which as indicated earlier may play a positive role for supporting poi recommendations in lbsns. in short, we are interested in studying the impact of geographical in uence and social in uence on poi recommendations in lbsns. our approach for supporting poi recommendation service in lbsns is to develop. ective collaborative recommendation techniques that discover pois of users interests by incorporating the three complementary factors: user preference of pois; ii social in uence; and iii geographical in uence. notice that users implicit preferences of pois can be derived from their check in activities on pois. by considering twousers whohavechecked intoalot of common pois as similar users, we may discover the implicit preference of a user through the previous check in activities of her similar users. since and shares many commonly visited pois, they may be considered as similar users who are assumed to share similar check in behaviors, ie, preference of pois. as a result, is a good candidate for recommendation to user since has visited this poi before. on the other hand, social in uence of friends can be incorporated in the recommendation process. for example, when considering as a recommendations candidate for, the social in uence of on may contribute to the decision making. finally, the geographical in uence of pois on nearby pois can be considered. as shown in the example, since has visited and before, their nearby pois and may be considered positively due to the geographical in uence. as discussed earlier, the conventional item recommendation techniques based on user preference and social in uence seem to be applicable for poi recommendation. ectiveness on poi recommendations in lbsns have not been studied. most importantly, the idea of incorporating the geographical in uence between pois, which is refreshing and promising for poi recommendation, has not been investigated previously. in this paper, we examine the geographical clustering phenomenon of user check in activities in lbsns and propose a power law probabilistic model to capture geographical in uence among pois. accordingly, we realize the targeted collaborative poi recommendation service for lbsns by incorporating the geographical in uence of pois via bayesian theory. finally, we propose a uni ed location recommendation framework to fuse user preference to pois along with the social in uence among users and the geographical in uence among pois. in summary, the contributions we made in this research work are four fold. we study the problem of supporting poi recommendation in location based social networking systems, where pois are uniquely di erent from other recommended items in conventional recommender systems because of the fact that physical interactions are required between users and pois. hence, we investigate the geographical in uence between pois and propose to incorporate geographical in uence along with user preference and social in uence in the collaborative recommendation techniques we develop for poi recommendations in lbsns. we develop a novel idea to capture the geographical in uence by investigating the geographical clustering phenomenon of user check in activities in lbsns. we propose to employ a power law probabilistic model to capture the geographical in uence among pois, and realize our collaborative poi recommendations based on geographical in uence via naive bayesian method. we propose a uni ed recommendation framework for poi recommendations by fusing user preference, social in uence and geographical in uence to devise a checkin probability prediction model for a given user to visit apoi. finally, we evaluate the proposed recommendation technique over large scale datasets we collected from two well known lbsns, ie, foursquare and whrrl. experimental results show that our proposed collaborative recommendation technique exhibits superior poi recommendation performance against other approaches. important ndings of our evaluation are summarized below. geographical in uence shows a more signi cant impact on the. ectiveness of poi recommendations in lbsns than social in uence, improving the recommendation performance by at least against social in uence. random walk and restart may not be suitable for poi recommendation in lbsns. based on our analysis over the real data and the experimental results, we nd that friends still re ect signi cantly di erent preferences and social tie cannot re ect the similarity of check in behavior among users. item based collaborative ltering do not provide results comparable to user based collaborative ltering, because many pois, in the current state of lbsns, only show a few user check ins. thus item similarity is not as accurate as user similarity. the rest of this paper is organized as follows. in section #, we provide some background on conventional recommendation techniques according to userown preference and social in uence and review related works in the literature. in section #, we describe the location recommendation process according to geographical in uence. in section #, we propose a location recommendation framework, which uni es all three factors together. in section #, we perform an empirical study on the di erent location recommendation algorithms upon two large scale datasets crawled from foursquare and whrrl, respectively. finally, in section #, we conclude the paper. newly emerging location based and event based social network services provide us with a new platform to understand users preferences based on their activity history. a user can only visit a limited number of venues events and most of them are within a limited distance range, so the user item matrix is very sparse, which creates a big challenge for traditional collaborative filtering based recommender systems. the problem becomes more challenging when people travel to a new city where they have no activity history. in this paper, we propose lcars, a location content aware recommender system that offers a particular user a set of venues or events by giving consideration to both personal interest and local preference. this recommender system can facilitate people travel not only near the area in which they live, but also in a city that is new to them. specifically, lcars consists of two components: offline modeling and online recommendation. the offline modeling part, called lca lda, is designed to learn the interest of each individual user and the local preference of each individual city by capturing item co occurrence patterns and exploiting item contents. the online recommendation part automatically combines the learnt interest of the querying user and the local preference of the querying city to produce the toprecommendations. to speed up this online process, a scalable query processing technique is developed by extending the classic threshold algorithm. we evaluate the performance of our recommender system on two large scale real data sets, doubanevent and foursquare. the results show the superiority of lcars in recommending spatial items for users, especially when traveling to new cities, in terms of both effectiveness and efficiency. newly emerging event based social network services, such as meetup and doubanevent, provide online platforms for users to establish social events which will be held in physical places. given a created social event, users may express their intent to join by replying yes, no or maybe. meanwhile, the advances in location acquisition and wireless communication technologies enable users to add a location dimension to traditional social networks, fostering the growth of location based social networking services, such as foursquare and gowalla which allow users to check in at spatial venues and rate their visit via mobile devices. by answering these two questions, we can satisfy the personalized information needs for many users in their daily routines and trip planning. for simplicity, we propose the notion of spatial items to denote both venues and events in a uni ed way, so that we can de ne our problem as follows: given a querying userwith a querying city lu, ndinteresting spatial items within lu, that match the preference of. however, inferring user preferences for spatial items is very challenging by using users activity history in an ebsn or lbsn. first, a user can only visit a limited number of physical venues and attend a limited number of social events. this leads to a sparse user item matrix for most existing location based recommender systems, which directly use collaborative ltering based methods over spatial items. second, the observation of travel locality makes the task more challenging considering that a user travels to a new place where he she does not have any activity history. the observation of travel locality made on ebsns and lbsns shows that users tend to travel a limited distance when visiting venues and attending events. an investigation shows that the activity records generated by users in their non home cities are very few and only take up of the activity records they left in their home cities. this observation of travel locality is quite common in the real world, aggravating the data sparsity problem with personalized spatial item recommendations. in this case, solely using a cf based method is not feasible any more, especially when coping with the new city problem, be lca lda user user local profile db interest model preference figure #: the architecture framework of lcars cause a querying user usually does not have enough activity history of spatial items in a city that is new to him her. let us assume, for example, that querying useris a shopaholic and often visits shopping mallin his her home city; is a popular local shopping mall in city lv that is new to. intuitively, a good recommender system should recommendtowhen he she travels to lv. however, the pure cf based methods fail to do so. for the item based cf, there are few common users betweenandaccording to the property of travel locality, resulting in the low similarity between the two items user vectors. for the user based cf, it is most likely that all thenearest neighbors of userlive in the same city as, and that few of them have visitedaccording to the property of travel locality. to this end, we propose a location content aware recommender system that exploits both the location and content information of spatial items to alleviate the data sparsity problem, especially the new city problem. as is shown in figure #, lcars consists of two main parts: of ine modeling and online recommendation. the of ine model, lca lda, is designed to model user preferences to spatial items by simultaneously considering the following two factors in a uni ed manner. user interest: music lovers may be more interested in concerts while shopaholics would pay more attention to shopping malls. local preference: when users visit a city, especially a city that is new to them, they are more likely to see local attractions and attend events that are popular in the city. thus, the preferences of local people are a valuable resource for making a recommendation, especially when people travel to an unfamiliar area where they have little knowledge about the neighborhood. lca lda can automatically learn both user interest and local preference from the user activity history. exploiting local preference can address the issue of data sparsity to some extent. to further alleviate the data sparsity problem, lca lda exploits the content information of spatial items to link content similar spatial items together, facilitating peopletravel not only near their home regions but also to cities that are new to them. it is worth mentioning that lca lda can also capture the item co occurrence patterns to link relevant items together, just like item based collaborative ltering methods. to our best knowledge, ideas for unifying the in uence of local preferences, collaborative ltering and content based recommendation are unexplored and very challenging. given a querying userwith a querying city lu, the online recommendation part computes a ranking score for each spatial itemwithin lu by automatically combinings interest and the local preference of lu, which are learned of inebylca lda tospeed up the process of online recommendation, we propose a scalable query processing technique for toprecommendations which separates the of ine scoring computation from online scoring computation to minimize the query time. speci cally, we partition all spatial items into locations at a given level such as cities. for each location, as is shown in figure #, we storelists of spatial items that fall into the location and each list is sorted by the items of ine score in the corresponding dimension. at query time, we retrieve all spatial items within lu, and then extend the threshold algorithm to compute the topspatial items by combining the score of each candidate item fromscorers. the primary contributions of our research are summarized as follows. we argue that local preference and item content information are important for modeling user preference and handling the data sparsity problem, and propose lca lda, a novel location content aware probabilistic generative model that quanti es and incorporates both local preference and item content information in the spatial item recommendation process. we design a scalable query processing technique to improve the recommendation ef ciency, enabling an online recommendation scenario. we conduct extensive experiments to evaluate the performance of our recommender system on two large scale real data sets. the results show the superiority of our proposals in recommending spatial items for users, especially when traveling to new cities, in terms of both effectiveness and ef ciency. the remainder of the paper is organized as follows. section # details the location content aware recommender system lcars. we report the experimental results in section #. section # reviews the related work and we conclude the paper in section #. the availability of user check in data in large volume from the rapid growing location based social networks enables many important location aware services to users. point of interest recommendation is one of such services, which is to recommend places where users have not visited before. several techniques have been recently proposed for the recommendation service. however, no existing work has considered the temporal information for poi recommendations in lbsns. we believe that time plays an important role in poi recommendations because most users tend to visit different places at different time in a day, \eg visiting a restaurant at noon and visiting a bar at night. in this paper, we define a new problem, namely, the time aware poi recommendation, to recommend pois for a given user at a specified time in a day. to solve the problem, we develop a collaborative recommendation model that is able to incorporate temporal information. moreover, based on the observation that users tend to visit nearby pois, we further enhance the recommendation model by considering geographical information. our experimental results on two real world datasets show that the proposed approach outperforms the state of the art poi recommendation methods substantially. the availability of user check in data in large volume from the rapid growing location based social networks enables a number of important location aware services. point of interest recommendation is one of such services, which is to recommend pois that users have not visited before. it has been observed that: users tend to visit nearby places, and users tend to visit different places in different time slots, and in the same time slot, users tend to periodically visit the same places. for example, users usually visit a restaurant during lunch hours, and visit a pub at night. in this paper, we focus on the problem of time aware poi recommendation, which aims at recommending a list of pois for a user to visit at a given time. to exploit both geographical and temporal influences in time aware poi recommendation, we propose the geographical temporal influences aware graph to model check in records, geographical influence and temporal influence. for effective and efficient recommendation based on gtag, we develop a preference propagation algorithm named breadth first preference propagation. the algorithm follows a relaxed breath first search strategy, and returns recommendation results within at most propagation steps. our experimental results on two real world datasets show that the proposed graph based approach outperforms state of the art poi recommendation methods substantially. location based social networks, such as foursquare and facebook places, have become increasingly popular recently. they provide a platform for millions of users to share their geographical locations and experiences through check ins. each check permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for pro. figure #: an example check in in represents a uservisit to a point of interest, such as a restaurant, a sightseeing site, etc, at a speci. figure # gives an example check in: a user named anon. as of january year#, foursquare accumulated over billion check ins made by million users. the availability of user check in data in large volume. ers the opportunity to design appealing services to facilitate users travels and social interactions. poi recommendation is one of such services, which aims at recommending pois to users who have not visited them before. note that, it is common to have thousands of pois even in a small city, and a user may have visited only a small portion of them. poi recommendation can help both residents and visitors to explore new interesting places in a city. on the other hand, poi recommendation certainly bene ts the business owners of pois for attracting more customers. in this paper, we focus on the problem of time aware poi recommendation, which is to recommend pois for a target user to visit at a speci. the recommendation results are time aware due to the observation that a user tends to go to di erent places at di erent time slots. for example, a person is more likely to go to a pub rather than a restaurant at midnight. from historical check in records obtained from foursquare or other sources, two observations have been made in existing studies related to poi recommendation. first, many users tend to visit nearby places. we refer to this observation as the geographical in uence on users daily activities. second, many users tend to visit di erent places at di erent time slots and periodically visit the same places in the same time slot. for example, users usually go to work places in the morning and have dinner at restaurants in the early evening. we refer to this observation as the temporal in uence on users daily activities. the geographical in uence suggests that the chance of a user visiting a poi will be higher if this poi is closer to the userpreviously visited pois. in other words, a poi recommendation algorithm should consider geographical in uence and rank such pois higher. on the other hand, the temporal in uence suggests that a poi recommendation algorithm shall consider user mobility pattern and recommend the right types of places based on the time a user plans to visit. for example, when we recommend pois for a user to visit during lunch hour, a restaurant should be given a higher priority than a pub. to exploit both geographical and temporal in uences for timeaware poi recommendation, we propose a graph based approach. in our approach, a graph named geographical temporal in uences aware graph is constructed using all users check in records. gtag consists of three types of nodes and two types of links. each user is represented by a user node that connects to a set of session nodes of the user, each of which represents a time slot. a session node of a user is connected to a poi node if the user of the session node visits the poi in the corresponding time slot. a pair of edges form a check in link, which represents a check in record of the user. two poi nodes are connected through a poi link if they are located geographically near each other. hence, gtag embeds both the temporal and geographical information from the check in records. introducing the session nodes for each user will make the data more sparse, which is a challenge for recommendation. to alleviate the data sparsity problem, we propose to compute the importance of each session, and the sessions close to the target session are assigned larger weights, since the behaviors of a user in two close time slots are similar. ectiveness,ciency is also an important consideration in designing recommendation algorithms, for the number of candidate items being always very large. cient recommendation algorithm named breadth rst preference propagation. the algorithm follows a relaxed breath rst search strategy, and returns recommendation results within propagation steps. in our experiments on two real world datasets, the proposed gtag with bpp signi cantly outperforms state of the art algorithms including the random walk based algorithms. to summarize, the main contributions of this paper are three fold: we propose the geographical temporal in uences aware graph for time aware poi recommendation, which encodes both geographical and temporal information of user check in records. cient breadth rst preference propagation algorithm for time aware recommendation on gtag exploiting both geographical and temporal in uences. we conduct extensive experiments to evaluate the proposed method on two publicly available lbsn datasets collected from foursquare and gowalla, respectively. experimental results show that our proposed method outperforms state ofthe art methods for time aware poi recommendation. the rest of the paper is organized as follows: we review previous work in section #, and report the datasets and the observations on temporal in uence in section #. in sections and, we introduce the gtag and the recommendation algorithm bpp, respectively. the experimental results are presented in section #. finally, we conclude this paper in section #. to copy otherwise, or republish, to post on servers or to redistribute to lists, requires prior speci. or commercial advantage and that copies bear this notice and the full citation on the rst page. copyrights for components of this work owned by others than acm must be honored. utilizing the structured properties of the gtag, we propose an.